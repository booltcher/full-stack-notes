### XSS(cross site scripting)

跨站脚本攻击

在网站上注入恶意的客户端代码，通过恶意脚本对客户端网页进行篡改，窃取用户信息

##### 反射型：

1. 攻击者构建特殊的URL，包含恶意代码
2. 用户打开带有恶意代码的URL时，网站服务端将恶意代码从URL取走，拼接在HTML中返回给浏览器

1. 浏览器接收到响应后解析执行，恶意代码也被执行



##### 存储型：

1. 攻击者将恶意代码提交到目标网站的数据库中
2. 用户打开目标网站时，网站服务端将恶意代码从数据库取出，拼接在HTML中返回给浏览器

1. 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行



##### DOM型：

1. 攻击者构建特殊的URL，包含恶意代码
2. 用户打开带有恶意代码的URL

1. 浏览器接收到响应后解析执行，恶意代码也被执行
2. 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作



这种类型靠的就是浏览器端的DOM解析，防范DOM型XSS完全是前端的责任。



#### 防御XSS

只要有输入数据的地方，就可能有XSS危险



#### 常用防范方式：

- httpOnly：在cookie中设置httpOnly属性后，js脚本将无法读取到cookie信息
- 输入过滤：对输入的格式检查

- 转义HTML：对引号尖括号斜杠等进行转义
- 白名单



#### 预防DOM XSS：

1. innerHTML，outHTML，document.write()要特别小心，尽量使用textContent，setAttribute
2. vue 不使用v-html

1. 不适用eval settimeout setInterval



### CSRF(cross site request forgery)

跨站请求伪造

1. 登录A，并在本地生成cookie
2. 在不登出A的情况下，访问危险网站B



#### 特点：

- 攻击一般发起在第三方网站，而不是被攻击的网站。被攻击的网站无法防止攻击发生。
- 攻击利用受害者在被攻击网站的登陆凭证，冒充受害者提交操作

- 不能获取受害者的登陆凭证，仅仅是冒用
- 跨站请求可以用各种方式：图片URL，超链接，CORS，Form提交等等



#### 防御：

- 验证码：强制用户进行交互，才能完成最终请求
- Refer check请求来源限制

- token